<app-navbar></app-navbar>

<div *ngIf="carga" class="fixed inset-0 flex justify-center items-center bg-slate-400 bg-opacity-75 z-50">
    <span class="loading loading-dots loading-lg"></span>
</div>

<div class="h-5/6 flex items-center justify-center">

    <div class="card lg:card-side w-11/12 flex justify-center m-2">
        <figure>
            <img [src]="url" />
        </figure>

        <div class="card-body flex flex-col justify-center text-center">

            <div class="m-1">
                <p class="text-center font-bold text-4xl">{{perfil.nombre}} {{perfil.apellidoPaterno}}
                    {{perfil.apellidoMaterno}}</p>
            </div>
            <hr class="text-black border-2">

            <div class="flex flex-row justify-evenly my-1">
                <div class=" flex flex-row items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path
                            d="m15 1.784-.796.795a1.125 1.125 0 1 0 1.591 0L15 1.784ZM12 1.784l-.796.795a1.125 1.125 0 1 0 1.591 0L12 1.784ZM9 1.784l-.796.795a1.125 1.125 0 1 0 1.591 0L9 1.784ZM9.75 7.547c.498-.021.998-.035 1.5-.042V6.75a.75.75 0 0 1 1.5 0v.755c.502.007 1.002.021 1.5.042V6.75a.75.75 0 0 1 1.5 0v.88l.307.022c1.55.117 2.693 1.427 2.693 2.946v1.018a62.182 62.182 0 0 0-13.5 0v-1.018c0-1.519 1.143-2.829 2.693-2.946l.307-.022v-.88a.75.75 0 0 1 1.5 0v.797ZM12 12.75c-2.472 0-4.9.184-7.274.54-1.454.217-2.476 1.482-2.476 2.916v.384a4.104 4.104 0 0 1 2.585.364 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 3.67 0 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 3.67 0 2.605 2.605 0 0 0 2.33 0 4.104 4.104 0 0 1 2.585-.364v-.384c0-1.434-1.022-2.7-2.476-2.917A49.138 49.138 0 0 0 12 12.75ZM21.75 18.131a2.604 2.604 0 0 0-1.915.165 4.104 4.104 0 0 1-3.67 0 2.605 2.605 0 0 0-2.33 0 4.104 4.104 0 0 1-3.67 0 2.605 2.605 0 0 0-2.33 0 4.104 4.104 0 0 1-3.67 0 2.604 2.604 0 0 0-1.915-.165v2.494c0 1.035.84 1.875 1.875 1.875h15.75c1.035 0 1.875-.84 1.875-1.875v-2.494Z" />
                    </svg>
                    <p class="mx-2 text-xl">{{perfil.fechaNacimiento | date:'dd/MM/yyyy'}} </p>
                </div>

                <div class=" flex flex-row items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path fill-rule="evenodd"
                            d="M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"
                            clip-rule="evenodd" />
                    </svg>
                    <p class="mx-2 text-xl">{{calcularEdad(perfil.fechaNacimiento)}} a単os</p>
                </div>
            </div>
            <hr class="text-black border-2">

            <div class="flex flex-row justify-evenly flex-wrap my-1">
                <div class=" flex flex-row items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path fill-rule="evenodd"
                            d="M17.834 6.166a8.25 8.25 0 1 0 0 11.668.75.75 0 0 1 1.06 1.06c-3.807 3.808-9.98 3.808-13.788 0-3.808-3.807-3.808-9.98 0-13.788 3.807-3.808 9.98-3.808 13.788 0A9.722 9.722 0 0 1 21.75 12c0 .975-.296 1.887-.809 2.571-.514.685-1.28 1.179-2.191 1.179-.904 0-1.666-.487-2.18-1.164a5.25 5.25 0 1 1-.82-6.26V8.25a.75.75 0 0 1 1.5 0V12c0 .682.208 1.27.509 1.671.3.401.659.579.991.579.332 0 .69-.178.991-.579.3-.4.509-.99.509-1.671a8.222 8.222 0 0 0-2.416-5.834ZM15.75 12a3.75 3.75 0 1 0-7.5 0 3.75 3.75 0 0 0 7.5 0Z"
                            clip-rule="evenodd" />
                    </svg>
                    <p class="mx-2 text-xl">{{perfil.correo}}</p>
                </div>

                <div class="flex flex-row items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6">
                        <path fill-rule="evenodd"
                            d="M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z"
                            clip-rule="evenodd" />
                    </svg>
                    <p class="mx-2 text-xl">{{perfil.telefono}}</p>
                </div>
            </div>
            <hr class="text-black border-2">


            <div class="card-actions my-2 flex flex-row justify-evenly items-center">
                <button (click)="abrirModalEditarEmail()"
                    class="btn m-1 bg-teal-500 text-white rounded-md hover:bg-teal-300 hover:border-teal-300">Cambiar
                    correo electronico</button>
                <button (click)="abrirModalEditarPass()"
                    class="btn m-1 bg-teal-500 text-white rounded-md hover:bg-teal-300 hover:border-teal-300">Cambiar
                    contrase単a</button>
            </div>
        </div>

    </div>

</div>

<dialog #editarPass id="editarPass" class="modal">
    <div class="modal-box w-5/6 max-w-5xl ">
        <h3 class="text-lg font-bold">Editar contrase単a</h3>
        <form [formGroup]="FormularioContrasenia">

            <div class="flex flex-row flex-wrap justify-center mt-2">

                <div class="mx-1 w-auto grow">
                    <label class="block text-center text-black">Nueva Contrase単a</label>
                    <input type="password" class="w-full rounded-md py-2 px-3 flex-auto" placeholder="*****"
                        formControlName="contrasenia">
                    <p class="font-size: small text-red-600" *ngIf="campoValidoContrasenia('contrasenia')">Este campo es
                        requerido</p>
                </div>

            </div>

        </form>
        <div class="modal-action">
            <form method="dialog">
                <button
                    class="btn bg-red-500 text-white rounded-md hover:bg-red-300 hover:border-red-300 m-1">Cancelar</button>
                <button (click)="actualizarContrasenia()" [disabled]="!FormularioContrasenia.valid"
                    class="btn bg-teal-500 text-white rounded-md hover:bg-teal-300 hover:border-teal-300">Guardar</button>
            </form>

        </div>
    </div>
</dialog>

<dialog #editarEmail id="editarEmail" class="modal">
    <div class="modal-box w-5/6 max-w-5xl ">
        <h3 class="text-lg font-bold">Editar correo</h3>
        <form [formGroup]="FormularioEmail">

            <div class="flex flex-row flex-wrap justify-center mt-2">

                <div class="mx-1 w-auto grow">
                    <label class="block text-center text-black">Nuevo Correo</label>
                    <input type="text" class="w-full rounded-md py-2 px-3 flex-auto" placeholder="perfil@corre.com"
                        formControlName="correo">
                    <p class="font-size: small text-red-600" *ngIf="campoValidoEmail('correo')">Este campo es requerido
                    </p>
                </div>

            </div>

        </form>
        <div class="modal-action">
            <form method="dialog">
                <button
                    class="btn bg-red-500 text-white rounded-md hover:bg-red-300 hover:border-red-300 m-1">Cancelar</button>
                <button (click)="actualizarCorreo()" [disabled]="!FormularioEmail.valid"
                    class="btn bg-teal-500 text-white rounded-md hover:bg-teal-300 hover:border-teal-300">Guardar</button>
            </form>

        </div>
    </div>
</dialog>